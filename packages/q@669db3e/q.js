(function(e){if("function"==typeof bootstrap)bootstrap("promise",e);else if("object"==typeof exports)module.exports=e();else if("function"==typeof define&&define.amd)define(e);else if("undefined"!=typeof ses){if(!ses.ok())return;ses.makeQ=e}else Q=e()})(function(){"use strict";function e(e){return function(){return K.apply(e,arguments)}}function t(e){return e===Object(e)}function n(e){return"[object StopIteration]"===it(e)||e instanceof W}function i(e,t){if(F&&t.stack&&"object"==typeof e&&null!==e&&e.stack&&-1===e.stack.indexOf(ot)){for(var n=[],i=t;i;i=i.source)i.stack&&n.unshift(i.stack);n.unshift(e.stack);var o=n.join("\n"+ot+"\n");e.stack=r(o)}}function r(e){for(var t=e.split("\n"),n=[],i=0;t.length>i;++i){var r=t[i];a(r)||o(r)||!r||n.push(r)}return n.join("\n")}function o(e){return-1!==e.indexOf("(module.js:")||-1!==e.indexOf("(node.js:")}function s(e){var t=/at .+ \((.+):(\d+):(?:\d+)\)$/.exec(e);if(t)return[t[1],Number(t[2])];var n=/at ([^ ]+):(\d+):(?:\d+)$/.exec(e);if(n)return[n[1],Number(n[2])];var i=/.*@(.+):(\d+)$/.exec(e);return i?[i[1],Number(i[2])]:void 0}function a(e){var t=s(e);if(!t)return!1;var n=t[0],i=t[1];return n===H&&i>=X&&ut>=i}function l(){if(F)try{throw Error()}catch(e){var t=e.stack.split("\n"),n=t[0].indexOf("@")>0?t[1]:t[2],i=s(n);if(!i)return;return H=i[0],i[1]}}function h(e,t,n){return function(){return"undefined"!=typeof console&&"function"==typeof console.warn&&console.warn(t+" is deprecated, use "+n+" instead.",Error("").stack),e.apply(e,arguments)}}function u(e){return v(e)?e:y(e)?P(e):k(e)}function c(){function e(e){t=e,o.source=e,$(n,function(t,n){U(function(){e.promiseDispatch.apply(e,n)})},void 0),n=void 0,i=void 0}var t,n=[],i=[],r=et(c.prototype),o=et(f.prototype);if(o.promiseDispatch=function(e,r,o){var s=J(arguments);n?(n.push(s),"when"===r&&o[1]&&i.push(o[1])):U(function(){t.promiseDispatch.apply(t,s)})},o.valueOf=h(function(){if(n)return o;var e=g(t);return v(e)&&(t=e),e},"valueOf","inspect"),o.inspect=function(){return t?t.inspect():{state:"pending"}},u.longStackSupport&&F)try{throw Error()}catch(s){o.stack=s.stack.substring(s.stack.indexOf("\n")+1)}return r.promise=o,r.resolve=function(n){t||e(u(n))},r.fulfill=function(n){t||e(k(n))},r.reject=function(n){t||e(L(n))},r.notify=function(e){t||$(i,function(t,n){U(function(){n(e)})},void 0)},r}function p(e){if("function"!=typeof e)throw new TypeError("resolver must be a function.");var t=c();try{e(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}return t.promise}function d(e){return p(function(t,n){for(var i=0,r=e.length;r>i;i++)u(e[i]).then(t,n)})}function f(e,t,n){void 0===t&&(t=function(e){return L(Error("Promise does not support operation: "+e))}),void 0===n&&(n=function(){return{state:"unknown"}});var i=et(f.prototype);if(i.promiseDispatch=function(n,r,o){var s;try{s=e[r]?e[r].apply(i,o):t.call(i,r,o)}catch(a){s=L(a)}n&&n(s)},i.inspect=n,n){var r=n();"rejected"===r.state&&(i.exception=r.reason),i.valueOf=h(function(){var e=n();return"pending"===e.state||"rejected"===e.state?i:e.value})}return i}function m(e,t,n,i){return u(e).then(t,n,i)}function g(e){if(v(e)){var t=e.inspect();if("fulfilled"===t.state)return t.value}return e}function v(e){return t(e)&&"function"==typeof e.promiseDispatch&&"function"==typeof e.inspect}function y(e){return t(e)&&"function"==typeof e.then}function _(e){return v(e)&&"pending"===e.inspect().state}function b(e){return!v(e)||"fulfilled"===e.inspect().state}function w(e){return v(e)&&"rejected"===e.inspect().state}function C(){lt||"undefined"==typeof window||window.Touch||!window.console||console.warn("[Q] Unhandled rejection reasons (should be empty):",st),lt=!0}function x(){for(var e=0;st.length>e;e++){var t=st[e];console.warn("Unhandled rejection reason:",t)}}function S(){st.length=0,at.length=0,lt=!1,ht||(ht=!0,"undefined"!=typeof process&&process.on&&process.on("exit",x))}function O(e,t){ht&&(at.push(e),t&&t.stack!==void 0?st.push(t.stack):st.push("(no stack) "+t),C())}function E(e){if(ht){var t=Q(at,e);-1!==t&&(at.splice(t,1),st.splice(t,1))}}function L(e){var t=f({when:function(t){return t&&E(this),t?t(e):this}},function(){return this},function(){return{state:"rejected",reason:e}});return O(t,e),t}function k(e){return f({when:function(){return e},get:function(t){return e[t]},set:function(t,n){e[t]=n},"delete":function(t){delete e[t]},post:function(t,n){return null===t||void 0===t?e.apply(void 0,n):e[t].apply(e,n)},apply:function(t,n){return e.apply(t,n)},keys:function(){return nt(e)}},void 0,function(){return{state:"fulfilled",value:e}})}function P(e){var t=c();return U(function(){try{e.then(t.resolve,t.reject,t.notify)}catch(n){t.reject(n)}}),t.promise}function T(e){return f({isDef:function(){}},function(t,n){return R(e,t,n)},function(){return u(e).inspect()})}function D(e,t,n){return u(e).spread(t,n)}function M(e){return function(){function t(e,t){var s;if(rt){try{s=i[e](t)}catch(a){return L(a)}return s.done?s.value:m(s.value,r,o)}try{s=i[e](t)}catch(a){return n(a)?a.value:L(a)}return m(s,r,o)}var i=e.apply(this,arguments),r=t.bind(t,"next"),o=t.bind(t,"throw");return r()}}function j(e){u.done(u.async(e)())}function A(e){throw new W(e)}function I(e){return function(){return D([this,V(arguments)],function(t,n){return e.apply(t,n)})}}function R(e,t,n){return u(e).dispatch(t,n)}function V(e){return m(e,function(e){var t=0,n=c();return $(e,function(i,r,o){var s;v(r)&&"fulfilled"===(s=r.inspect()).state?e[o]=s.value:(++t,m(r,function(i){e[o]=i,0===--t&&n.resolve(e)},n.reject,function(e){n.notify({index:o,value:e})}))},void 0),0===t&&n.resolve(e),n.promise})}function B(e){return m(e,function(e){return e=Z(e,u),m(V(Z(e,function(e){return m(e,Y,Y)})),function(){return e})})}function z(e){return u(e).allSettled()}function q(e,t){return u(e).then(void 0,void 0,t)}function N(e,t){return u(e).nodeify(t)}var F=!1;try{throw Error()}catch(G){F=!!G.stack}var H,W,X=l(),Y=function(){},U=function(){function e(){for(;t.next;){t=t.next;var n=t.task;t.task=void 0;var r=t.domain;r&&(t.domain=void 0,r.enter());try{n()}catch(s){if(o)throw r&&r.exit(),setTimeout(e,0),r&&r.enter(),s;setTimeout(function(){throw s},0)}r&&r.exit()}i=!1}var t={task:void 0,next:null},n=t,i=!1,r=void 0,o=!1;if(U=function(e){n=n.next={task:e,domain:o&&process.domain,next:null},i||(i=!0,r())},"undefined"!=typeof process&&process.nextTick)o=!0,r=function(){process.nextTick(e)};else if("function"==typeof setImmediate)r="undefined"!=typeof window?setImmediate.bind(window,e):function(){setImmediate(e)};else if("undefined"!=typeof MessageChannel){var s=new MessageChannel;s.port1.onmessage=function(){r=a,s.port1.onmessage=e,e()};var a=function(){s.port2.postMessage(0)};r=function(){setTimeout(e,0),a()}}else r=function(){setTimeout(e,0)};return U}(),K=Function.call,J=e(Array.prototype.slice),$=e(Array.prototype.reduce||function(e,t){var n=0,i=this.length;if(1===arguments.length)for(;;){if(n in this){t=this[n++];break}if(++n>=i)throw new TypeError}for(;i>n;n++)n in this&&(t=e(t,this[n],n));return t}),Q=e(Array.prototype.indexOf||function(e){for(var t=0;this.length>t;t++)if(this[t]===e)return t;return-1}),Z=e(Array.prototype.map||function(e,t){var n=this,i=[];return $(n,function(r,o,s){i.push(e.call(t,o,s,n))},void 0),i}),et=Object.create||function(e){function t(){}return t.prototype=e,new t},tt=e(Object.prototype.hasOwnProperty),nt=Object.keys||function(e){var t=[];for(var n in e)tt(e,n)&&t.push(n);return t},it=e(Object.prototype.toString);W="undefined"!=typeof ReturnValue?ReturnValue:function(e){this.value=e};var rt;try{Function("(function* (){ yield 1; })"),rt=!0}catch(G){rt=!1}var ot="From previous event:";u.resolve=u,u.nextTick=U,u.longStackSupport=!1,u.defer=c,c.prototype.makeNodeResolver=function(){var e=this;return function(t,n){t?e.reject(t):arguments.length>2?e.resolve(J(arguments,1)):e.resolve(n)}},u.promise=p,u.passByCopy=function(e){return e},f.prototype.passByCopy=function(){return this},u.join=function(e,t){return u(e).join(t)},f.prototype.join=function(e){return u([this,e]).spread(function(e,t){if(e===t)return e;throw Error("Can't join: not the same: "+e+" "+t)})},u.race=d,f.prototype.race=function(){return this.then(u.race)},u.makePromise=f,f.prototype.toString=function(){return"[object Promise]"},f.prototype.then=function(e,t,n){function r(t){try{return"function"==typeof e?e(t):t}catch(n){return L(n)}}function o(e){if("function"==typeof t){i(e,a);try{return t(e)}catch(n){return L(n)}}return L(e)}function s(e){return"function"==typeof n?n(e):e}var a=this,l=c(),h=!1;return U(function(){a.promiseDispatch(function(e){h||(h=!0,l.resolve(r(e)))},"when",[function(e){h||(h=!0,l.resolve(o(e)))}])}),a.promiseDispatch(void 0,"when",[void 0,function(e){var t,n=!1;try{t=s(e)}catch(i){if(n=!0,!u.onerror)throw i;u.onerror(i)}n||l.notify(t)}]),l.promise},u.when=m,f.prototype.thenResolve=function(e){return this.then(function(){return e})},u.thenResolve=function(e,t){return u(e).thenResolve(t)},f.prototype.thenReject=function(e){return this.then(function(){throw e})},u.thenReject=function(e,t){return u(e).thenReject(t)},u.nearer=g,u.isPromise=v,u.isPromiseAlike=y,u.isPending=_,f.prototype.isPending=function(){return"pending"===this.inspect().state},u.isFulfilled=b,f.prototype.isFulfilled=function(){return"fulfilled"===this.inspect().state},u.isRejected=w,f.prototype.isRejected=function(){return"rejected"===this.inspect().state};var st=[],at=[],lt=!1,ht=!0;u.resetUnhandledRejections=S,u.getUnhandledReasons=function(){return st.slice()},u.stopUnhandledRejectionTracking=function(){S(),"undefined"!=typeof process&&process.on&&process.removeListener("exit",x),ht=!1},S(),u.reject=L,u.fulfill=k,u.master=T,u.spread=D,f.prototype.spread=function(e,t){return this.all().then(function(t){return e.apply(void 0,t)},t)},u.async=M,u.spawn=j,u["return"]=A,u.promised=I,u.dispatch=R,f.prototype.dispatch=function(e,t){var n=this,i=c();return U(function(){n.promiseDispatch(i.resolve,e,t)}),i.promise},u.get=function(e,t){return u(e).dispatch("get",[t])},f.prototype.get=function(e){return this.dispatch("get",[e])},u.set=function(e,t,n){return u(e).dispatch("set",[t,n])},f.prototype.set=function(e,t){return this.dispatch("set",[e,t])},u.del=u["delete"]=function(e,t){return u(e).dispatch("delete",[t])},f.prototype.del=f.prototype["delete"]=function(e){return this.dispatch("delete",[e])},u.mapply=u.post=function(e,t,n){return u(e).dispatch("post",[t,n])},f.prototype.mapply=f.prototype.post=function(e,t){return this.dispatch("post",[e,t])},u.send=u.mcall=u.invoke=function(e,t){return u(e).dispatch("post",[t,J(arguments,2)])},f.prototype.send=f.prototype.mcall=f.prototype.invoke=function(e){return this.dispatch("post",[e,J(arguments,1)])},u.fapply=function(e,t){return u(e).dispatch("apply",[void 0,t])},f.prototype.fapply=function(e){return this.dispatch("apply",[void 0,e])},u["try"]=u.fcall=function(e){return u(e).dispatch("apply",[void 0,J(arguments,1)])},f.prototype.fcall=function(){return this.dispatch("apply",[void 0,J(arguments)])},u.fbind=function(e){var t=u(e),n=J(arguments,1);return function(){return t.dispatch("apply",[this,n.concat(J(arguments))])}},f.prototype.fbind=function(){var e=this,t=J(arguments);return function(){return e.dispatch("apply",[this,t.concat(J(arguments))])}},u.keys=function(e){return u(e).dispatch("keys",[])},f.prototype.keys=function(){return this.dispatch("keys",[])},u.all=V,f.prototype.all=function(){return V(this)},u.allResolved=h(B,"allResolved","allSettled"),f.prototype.allResolved=function(){return B(this)},u.allSettled=z,f.prototype.allSettled=function(){return this.then(function(e){return V(Z(e,function(e){function t(){return e.inspect()}return e=u(e),e.then(t,t)}))})},u.fail=u["catch"]=function(e,t){return u(e).then(void 0,t)},f.prototype.fail=f.prototype["catch"]=function(e){return this.then(void 0,e)},u.progress=q,f.prototype.progress=function(e){return this.then(void 0,void 0,e)},u.fin=u["finally"]=function(e,t){return u(e)["finally"](t)},f.prototype.fin=f.prototype["finally"]=function(e){return e=u(e),this.then(function(t){return e.fcall().then(function(){return t})},function(t){return e.fcall().then(function(){throw t})})},u.done=function(e,t,n,i){return u(e).done(t,n,i)},f.prototype.done=function(e,t,n){var r=function(e){U(function(){if(i(e,o),!u.onerror)throw e;u.onerror(e)})},o=e||t||n?this.then(e,t,n):this;"object"==typeof process&&process&&process.domain&&(r=process.domain.bind(r)),o.then(void 0,r)},u.timeout=function(e,t,n){return u(e).timeout(t,n)},f.prototype.timeout=function(e,t){var n=c(),i=setTimeout(function(){n.reject(Error(t||"Timed out after "+e+" ms"))},e);return this.then(function(e){clearTimeout(i),n.resolve(e)},function(e){clearTimeout(i),n.reject(e)},n.notify),n.promise},u.delay=function(e,t){return void 0===t&&(t=e,e=void 0),u(e).delay(t)},f.prototype.delay=function(e){return this.then(function(t){var n=c();return setTimeout(function(){n.resolve(t)},e),n.promise})},u.nfapply=function(e,t){return u(e).nfapply(t)},f.prototype.nfapply=function(e){var t=c(),n=J(e);return n.push(t.makeNodeResolver()),this.fapply(n).fail(t.reject),t.promise},u.nfcall=function(e){var t=J(arguments,1);return u(e).nfapply(t)},f.prototype.nfcall=function(){var e=J(arguments),t=c();return e.push(t.makeNodeResolver()),this.fapply(e).fail(t.reject),t.promise},u.nfbind=u.denodeify=function(e){var t=J(arguments,1);return function(){var n=t.concat(J(arguments)),i=c();return n.push(i.makeNodeResolver()),u(e).fapply(n).fail(i.reject),i.promise}},f.prototype.nfbind=f.prototype.denodeify=function(){var e=J(arguments);return e.unshift(this),u.denodeify.apply(void 0,e)},u.nbind=function(e,t){var n=J(arguments,2);return function(){function i(){return e.apply(t,arguments)}var r=n.concat(J(arguments)),o=c();return r.push(o.makeNodeResolver()),u(i).fapply(r).fail(o.reject),o.promise}},f.prototype.nbind=function(){var e=J(arguments,0);return e.unshift(this),u.nbind.apply(void 0,e)},u.nmapply=u.npost=function(e,t,n){return u(e).npost(t,n)},f.prototype.nmapply=f.prototype.npost=function(e,t){var n=J(t||[]),i=c();return n.push(i.makeNodeResolver()),this.dispatch("post",[e,n]).fail(i.reject),i.promise},u.nsend=u.nmcall=u.ninvoke=function(e,t){var n=J(arguments,2),i=c();return n.push(i.makeNodeResolver()),u(e).dispatch("post",[t,n]).fail(i.reject),i.promise},f.prototype.nsend=f.prototype.nmcall=f.prototype.ninvoke=function(e){var t=J(arguments,1),n=c();return t.push(n.makeNodeResolver()),this.dispatch("post",[e,t]).fail(n.reject),n.promise},u.nodeify=N,f.prototype.nodeify=function(e){return e?(this.then(function(t){U(function(){e(null,t)})},function(t){U(function(){e(t)})}),void 0):this};var ut=l();return u});