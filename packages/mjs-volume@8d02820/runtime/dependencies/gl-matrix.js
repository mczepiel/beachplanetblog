var global=window;(function(e,t){"object"==typeof exports?module.exports=t(global):"function"==typeof define&&define.amd?define([],function(){return t(e)}):t(e)})(this,function(e){"use strict";function t(e){return a=e}function n(){return a="undefined"!=typeof Float32Array?Float32Array:Array}var i=1e-6,r={};(function(){if("undefined"!=typeof Float32Array){var e=new Float32Array(1),t=new Int32Array(e.buffer);r.invsqrt=function(n){var i=.5*n;e[0]=n;var r=1.5;t[0]=1597463007-(t[0]>>1);var a=e[0];return a*(r-i*a*a)}}else r.invsqrt=function(e){return 1/Math.sqrt(e)}})();var a=null;n();var s={};s.create=function(e){var t=new a(3);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):t[0]=t[1]=t[2]=0,t},s.createFrom=function(e,t,n){var i=new a(3);return i[0]=e,i[1]=t,i[2]=n,i},s.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},s.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])&&i>Math.abs(e[2]-t[2])},s.add=function(e,t,n){return n&&e!==n?(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n):(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e)},s.subtract=function(e,t,n){return n&&e!==n?(n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n):(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e)},s.multiply=function(e,t,n){return n&&e!==n?(n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n):(e[0]*=t[0],e[1]*=t[1],e[2]*=t[2],e)},s.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},s.scale=function(e,t,n){return n&&e!==n?(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n):(e[0]*=t,e[1]*=t,e[2]*=t,e)},s.normalize=function(e,t){t||(t=e);var n=e[0],i=e[1],r=e[2],a=Math.sqrt(n*n+i*i+r*r);return a?1===a?(t[0]=n,t[1]=i,t[2]=r,t):(a=1/a,t[0]=n*a,t[1]=i*a,t[2]=r*a,t):(t[0]=0,t[1]=0,t[2]=0,t)},s.cross=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],s=t[0],o=t[1],l=t[2];return n[0]=r*l-a*o,n[1]=a*s-i*l,n[2]=i*o-r*s,n},s.length=function(e){var t=e[0],n=e[1],i=e[2];return Math.sqrt(t*t+n*n+i*i)},s.squaredLength=function(e){var t=e[0],n=e[1],i=e[2];return t*t+n*n+i*i},s.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},s.direction=function(e,t,n){n||(n=e);var i=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2],s=Math.sqrt(i*i+r*r+a*a);return s?(s=1/s,n[0]=i*s,n[1]=r*s,n[2]=a*s,n):(n[0]=0,n[1]=0,n[2]=0,n)},s.lerp=function(e,t,n,i){return i||(i=e),i[0]=e[0]+n*(t[0]-e[0]),i[1]=e[1]+n*(t[1]-e[1]),i[2]=e[2]+n*(t[2]-e[2]),i},s.dist=function(e,t){var n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(n*n+i*i+r*r)};var o=null,l=new a(4);s.unproject=function(e,t,n,i,r){r||(r=e),o||(o=f.create());var a=o,s=l;return s[0]=2*(e[0]-i[0])/i[2]-1,s[1]=2*(e[1]-i[1])/i[3]-1,s[2]=2*e[2]-1,s[3]=1,f.multiply(n,t,a),f.inverse(a)?(f.multiplyVec4(a,s),0===s[3]?null:(r[0]=s[0]/s[3],r[1]=s[1]/s[3],r[2]=s[2]/s[3],r)):null};var u=s.createFrom(1,0,0),h=s.createFrom(0,1,0),c=s.createFrom(0,0,1),p=s.create();s.rotationTo=function(e,t,n){n||(n=m.create());var i=s.dot(e,t),r=p;if(i>=1)m.set(g,n);else if(1e-6-1>i)s.cross(u,e,r),1e-6>s.length(r)&&s.cross(h,e,r),1e-6>s.length(r)&&s.cross(c,e,r),s.normalize(r),m.fromAngleAxis(Math.PI,r,n);else{var a=Math.sqrt(2*(1+i)),o=1/a;s.cross(e,t,r),n[0]=r[0]*o,n[1]=r[1]*o,n[2]=r[2]*o,n[3]=.5*a,m.normalize(n)}return n[3]>1?n[3]=1:-1>n[3]&&(n[3]=-1),n},s.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+"]"};var d={};d.create=function(e){var t=new a(9);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8]):t[0]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=0,t},d.createFrom=function(e,t,n,i,r,s,o,l,u){var h=new a(9);return h[0]=e,h[1]=t,h[2]=n,h[3]=i,h[4]=r,h[5]=s,h[6]=o,h[7]=l,h[8]=u,h},d.determinant=function(e){var t=e[0],n=e[1],i=e[2],r=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8];return t*(u*a-s*l)+n*(-u*r+s*o)+i*(l*r-a*o)},d.inverse=function(e,t){var n,i=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],h=e[7],c=e[8],p=c*o-l*h,f=-c*s+l*u,m=h*s-o*u,g=i*p+r*f+a*m;return g?(n=1/g,t||(t=d.create()),t[0]=p*n,t[1]=(-c*r+a*h)*n,t[2]=(l*r-a*o)*n,t[3]=f*n,t[4]=(c*i-a*u)*n,t[5]=(-l*i+a*s)*n,t[6]=m*n,t[7]=(-h*i+r*u)*n,t[8]=(o*i-r*s)*n,t):null},d.multiply=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],h=e[7],c=e[8],p=t[0],d=t[1],f=t[2],m=t[3],g=t[4],v=t[5],y=t[6],_=t[7],b=t[8];return n[0]=p*i+d*s+f*u,n[1]=p*r+d*o+f*h,n[2]=p*a+d*l+f*c,n[3]=m*i+g*s+v*u,n[4]=m*r+g*o+v*h,n[5]=m*a+g*l+v*c,n[6]=y*i+_*s+b*u,n[7]=y*r+_*o+b*h,n[8]=y*a+_*l+b*c,n},d.multiplyVec2=function(e,t,n){n||(n=t);var i=t[0],r=t[1];return n[0]=i*e[0]+r*e[3]+e[6],n[1]=i*e[1]+r*e[4]+e[7],n},d.multiplyVec3=function(e,t,n){n||(n=t);var i=t[0],r=t[1],a=t[2];return n[0]=i*e[0]+r*e[3]+a*e[6],n[1]=i*e[1]+r*e[4]+a*e[7],n[2]=i*e[2]+r*e[5]+a*e[8],n},d.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},d.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])&&i>Math.abs(e[2]-t[2])&&i>Math.abs(e[3]-t[3])&&i>Math.abs(e[4]-t[4])&&i>Math.abs(e[5]-t[5])&&i>Math.abs(e[6]-t[6])&&i>Math.abs(e[7]-t[7])&&i>Math.abs(e[8]-t[8])},d.identity=function(e){return e||(e=d.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},d.transpose=function(e,t){if(!t||e===t){var n=e[1],i=e[2],r=e[5];return e[1]=e[3],e[2]=e[6],e[3]=n,e[5]=e[7],e[6]=i,e[7]=r,e}return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t},d.toMat4=function(e,t){return t||(t=f.create()),t[15]=1,t[14]=0,t[13]=0,t[12]=0,t[11]=0,t[10]=e[8],t[9]=e[7],t[8]=e[6],t[7]=0,t[6]=e[5],t[5]=e[4],t[4]=e[3],t[3]=0,t[2]=e[2],t[1]=e[1],t[0]=e[0],t},d.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+"]"};var f={};f.create=function(e){var t=new a(16);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t},f.createFrom=function(e,t,n,i,r,s,o,l,u,h,c,p,d,f,m,g){var v=new a(16);return v[0]=e,v[1]=t,v[2]=n,v[3]=i,v[4]=r,v[5]=s,v[6]=o,v[7]=l,v[8]=u,v[9]=h,v[10]=c,v[11]=p,v[12]=d,v[13]=f,v[14]=m,v[15]=g,v},f.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},f.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])&&i>Math.abs(e[2]-t[2])&&i>Math.abs(e[3]-t[3])&&i>Math.abs(e[4]-t[4])&&i>Math.abs(e[5]-t[5])&&i>Math.abs(e[6]-t[6])&&i>Math.abs(e[7]-t[7])&&i>Math.abs(e[8]-t[8])&&i>Math.abs(e[9]-t[9])&&i>Math.abs(e[10]-t[10])&&i>Math.abs(e[11]-t[11])&&i>Math.abs(e[12]-t[12])&&i>Math.abs(e[13]-t[13])&&i>Math.abs(e[14]-t[14])&&i>Math.abs(e[15]-t[15])},f.identity=function(e){return e||(e=f.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},f.transpose=function(e,t){if(!t||e===t){var n=e[1],i=e[2],r=e[3],a=e[6],s=e[7],o=e[11];return e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=n,e[6]=e[9],e[7]=e[13],e[8]=i,e[9]=a,e[11]=e[14],e[12]=r,e[13]=s,e[14]=o,e}return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},f.determinant=function(e){var t=e[0],n=e[1],i=e[2],r=e[3],a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],h=e[9],c=e[10],p=e[11],d=e[12],f=e[13],m=e[14],g=e[15];return d*h*o*r-u*f*o*r-d*s*c*r+a*f*c*r+u*s*m*r-a*h*m*r-d*h*i*l+u*f*i*l+d*n*c*l-t*f*c*l-u*n*m*l+t*h*m*l+d*s*i*p-a*f*i*p-d*n*o*p+t*f*o*p+a*n*m*p-t*s*m*p-u*s*i*g+a*h*i*g+u*n*o*g-t*h*o*g-a*n*c*g+t*s*c*g},f.inverse=function(e,t){t||(t=e);var n,i=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],h=e[7],c=e[8],p=e[9],d=e[10],f=e[11],m=e[12],g=e[13],v=e[14],y=e[15],_=i*l-r*o,b=i*u-a*o,S=i*h-s*o,C=r*u-a*l,w=r*h-s*l,x=a*h-s*u,O=c*g-p*m,E=c*v-d*m,T=c*y-f*m,k=p*v-d*g,M=p*y-f*g,L=d*y-f*v,P=_*L-b*M+S*k+C*T-w*E+x*O;return P?(n=1/P,t[0]=(l*L-u*M+h*k)*n,t[1]=(-r*L+a*M-s*k)*n,t[2]=(g*x-v*w+y*C)*n,t[3]=(-p*x+d*w-f*C)*n,t[4]=(-o*L+u*T-h*E)*n,t[5]=(i*L-a*T+s*E)*n,t[6]=(-m*x+v*S-y*b)*n,t[7]=(c*x-d*S+f*b)*n,t[8]=(o*M-l*T+h*O)*n,t[9]=(-i*M+r*T-s*O)*n,t[10]=(m*w-g*S+y*_)*n,t[11]=(-c*w+p*S-f*_)*n,t[12]=(-o*k+l*E-u*O)*n,t[13]=(i*k-r*E+a*O)*n,t[14]=(-m*C+g*b-v*_)*n,t[15]=(c*C-p*b+d*_)*n,t):null},f.toRotationMat=function(e,t){return t||(t=f.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.toMat3=function(e,t){return t||(t=d.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},f.toInverseMat3=function(e,t){var n,i=e[0],r=e[1],a=e[2],s=e[4],o=e[5],l=e[6],u=e[8],h=e[9],c=e[10],p=c*o-l*h,f=-c*s+l*u,m=h*s-o*u,g=i*p+r*f+a*m;return g?(n=1/g,t||(t=d.create()),t[0]=p*n,t[1]=(-c*r+a*h)*n,t[2]=(l*r-a*o)*n,t[3]=f*n,t[4]=(c*i-a*u)*n,t[5]=(-l*i+a*s)*n,t[6]=m*n,t[7]=(-h*i+r*u)*n,t[8]=(o*i-r*s)*n,t):null},f.multiply=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],h=e[7],c=e[8],p=e[9],d=e[10],f=e[11],m=e[12],g=e[13],v=e[14],y=e[15],_=t[0],b=t[1],S=t[2],C=t[3];return n[0]=_*i+b*o+S*c+C*m,n[1]=_*r+b*l+S*p+C*g,n[2]=_*a+b*u+S*d+C*v,n[3]=_*s+b*h+S*f+C*y,_=t[4],b=t[5],S=t[6],C=t[7],n[4]=_*i+b*o+S*c+C*m,n[5]=_*r+b*l+S*p+C*g,n[6]=_*a+b*u+S*d+C*v,n[7]=_*s+b*h+S*f+C*y,_=t[8],b=t[9],S=t[10],C=t[11],n[8]=_*i+b*o+S*c+C*m,n[9]=_*r+b*l+S*p+C*g,n[10]=_*a+b*u+S*d+C*v,n[11]=_*s+b*h+S*f+C*y,_=t[12],b=t[13],S=t[14],C=t[15],n[12]=_*i+b*o+S*c+C*m,n[13]=_*r+b*l+S*p+C*g,n[14]=_*a+b*u+S*d+C*v,n[15]=_*s+b*h+S*f+C*y,n},f.multiply3=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],h=e[7],c=e[8],p=e[9],d=e[10],f=e[11],m=e[12],g=e[13],v=e[14],y=e[15],_=t[0],b=t[1],S=t[2],C=0;return n[0]=_*i+b*o+S*c+C*m,n[1]=_*r+b*l+S*p+C*g,n[2]=_*a+b*u+S*d+C*v,n[3]=_*s+b*h+S*f+C*y,_=t[4],b=t[5],S=t[6],C=0,n[4]=_*i+b*o+S*c+C*m,n[5]=_*r+b*l+S*p+C*g,n[6]=_*a+b*u+S*d+C*v,n[7]=_*s+b*h+S*f+C*y,_=t[8],b=t[9],S=t[10],C=0,n[8]=_*i+b*o+S*c+C*m,n[9]=_*r+b*l+S*p+C*g,n[10]=_*a+b*u+S*d+C*v,n[11]=_*s+b*h+S*f+C*y,n},f.multiplyVec3=function(e,t,n){n||(n=t);var i=t[0],r=t[1],a=t[2];return n[0]=e[0]*i+e[4]*r+e[8]*a+e[12],n[1]=e[1]*i+e[5]*r+e[9]*a+e[13],n[2]=e[2]*i+e[6]*r+e[10]*a+e[14],n},f.rotateVec3=function(e,t,n){n||(n=t);var i=t[0],r=t[1],a=t[2];return n[0]=e[0]*i+e[4]*r+e[8]*a,n[1]=e[1]*i+e[5]*r+e[9]*a,n[2]=e[2]*i+e[6]*r+e[10]*a,n},f.multiplyVec4=function(e,t,n){n||(n=t);var i=t[0],r=t[1],a=t[2],s=t[3];return n[0]=e[0]*i+e[4]*r+e[8]*a+e[12]*s,n[1]=e[1]*i+e[5]*r+e[9]*a+e[13]*s,n[2]=e[2]*i+e[6]*r+e[10]*a+e[14]*s,n[3]=e[3]*i+e[7]*r+e[11]*a+e[15]*s,n},f.translate=function(e,t,n){var i,r,a,s,o,l,u,h,c,p,d,f,m=t[0],g=t[1],v=t[2];return n&&e!==n?(i=e[0],r=e[1],a=e[2],s=e[3],o=e[4],l=e[5],u=e[6],h=e[7],c=e[8],p=e[9],d=e[10],f=e[11],n[0]=i,n[1]=r,n[2]=a,n[3]=s,n[4]=o,n[5]=l,n[6]=u,n[7]=h,n[8]=c,n[9]=p,n[10]=d,n[11]=f,n[12]=i*m+o*g+c*v+e[12],n[13]=r*m+l*g+p*v+e[13],n[14]=a*m+u*g+d*v+e[14],n[15]=s*m+h*g+f*v+e[15],n):(e[12]=e[0]*m+e[4]*g+e[8]*v+e[12],e[13]=e[1]*m+e[5]*g+e[9]*v+e[13],e[14]=e[2]*m+e[6]*g+e[10]*v+e[14],e[15]=e[3]*m+e[7]*g+e[11]*v+e[15],e)},f.scale=function(e,t,n){var i=t[0],r=t[1],a=t[2];return n&&e!==n?(n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*a,n[9]=e[9]*a,n[10]=e[10]*a,n[11]=e[11]*a,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n):(e[0]*=i,e[1]*=i,e[2]*=i,e[3]*=i,e[4]*=r,e[5]*=r,e[6]*=r,e[7]*=r,e[8]*=a,e[9]*=a,e[10]*=a,e[11]*=a,e)},f.rotate=function(e,t,n,i){var r,a,s,o,l,u,h,c,p,d,f,m,g,v,y,_,b,S,C,w,x,O,E,T,k=n[0],M=n[1],L=n[2],P=Math.sqrt(k*k+M*M+L*L);return P?(1!==P&&(P=1/P,k*=P,M*=P,L*=P),r=Math.sin(t),a=Math.cos(t),s=1-a,o=e[0],l=e[1],u=e[2],h=e[3],c=e[4],p=e[5],d=e[6],f=e[7],m=e[8],g=e[9],v=e[10],y=e[11],_=k*k*s+a,b=M*k*s+L*r,S=L*k*s-M*r,C=k*M*s-L*r,w=M*M*s+a,x=L*M*s+k*r,O=k*L*s+M*r,E=M*L*s-k*r,T=L*L*s+a,i?e!==i&&(i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]):i=e,i[0]=o*_+c*b+m*S,i[1]=l*_+p*b+g*S,i[2]=u*_+d*b+v*S,i[3]=h*_+f*b+y*S,i[4]=o*C+c*w+m*x,i[5]=l*C+p*w+g*x,i[6]=u*C+d*w+v*x,i[7]=h*C+f*w+y*x,i[8]=o*O+c*E+m*T,i[9]=l*O+p*E+g*T,i[10]=u*O+d*E+v*T,i[11]=h*O+f*E+y*T,i):null},f.rotateX=function(e,t,n){var i=Math.sin(t),r=Math.cos(t),a=e[4],s=e[5],o=e[6],l=e[7],u=e[8],h=e[9],c=e[10],p=e[11];return n?e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[4]=a*r+u*i,n[5]=s*r+h*i,n[6]=o*r+c*i,n[7]=l*r+p*i,n[8]=a*-i+u*r,n[9]=s*-i+h*r,n[10]=o*-i+c*r,n[11]=l*-i+p*r,n},f.rotateY=function(e,t,n){var i=Math.sin(t),r=Math.cos(t),a=e[0],s=e[1],o=e[2],l=e[3],u=e[8],h=e[9],c=e[10],p=e[11];return n?e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=a*r+u*-i,n[1]=s*r+h*-i,n[2]=o*r+c*-i,n[3]=l*r+p*-i,n[8]=a*i+u*r,n[9]=s*i+h*r,n[10]=o*i+c*r,n[11]=l*i+p*r,n},f.rotateZ=function(e,t,n){var i=Math.sin(t),r=Math.cos(t),a=e[0],s=e[1],o=e[2],l=e[3],u=e[4],h=e[5],c=e[6],p=e[7];return n?e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=a*r+u*i,n[1]=s*r+h*i,n[2]=o*r+c*i,n[3]=l*r+p*i,n[4]=a*-i+u*r,n[5]=s*-i+h*r,n[6]=o*-i+c*r,n[7]=l*-i+p*r,n},f.frustum=function(e,t,n,i,r,a,s){s||(s=f.create());var o=t-e,l=i-n,u=a-r;return s[0]=2*r/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2*r/l,s[6]=0,s[7]=0,s[8]=(t+e)/o,s[9]=(i+n)/l,s[10]=-(a+r)/u,s[11]=-1,s[12]=0,s[13]=0,s[14]=-(2*a*r)/u,s[15]=0,s},f.perspective=function(e,t,n,i,r){var a=n*Math.tan(e*Math.PI/360),s=a*t;return f.frustum(-s,s,-a,a,n,i,r)},f.ortho=function(e,t,n,i,r,a,s){s||(s=f.create());var o=t-e,l=i-n,u=a-r;return s[0]=2/o,s[1]=0,s[2]=0,s[3]=0,s[4]=0,s[5]=2/l,s[6]=0,s[7]=0,s[8]=0,s[9]=0,s[10]=-2/u,s[11]=0,s[12]=-(e+t)/o,s[13]=-(i+n)/l,s[14]=-(a+r)/u,s[15]=1,s},f.lookAt=function(e,t,n,i){i||(i=f.create());var r,a,s,o,l,u,h,c,p,d,m=e[0],g=e[1],v=e[2],y=n[0],_=n[1],b=n[2],S=t[0],C=t[1],w=t[2];return m===S&&g===C&&v===w?f.identity(i):(h=m-S,c=g-C,p=v-w,d=1/Math.sqrt(h*h+c*c+p*p),h*=d,c*=d,p*=d,r=_*p-b*c,a=b*h-y*p,s=y*c-_*h,d=Math.sqrt(r*r+a*a+s*s),d?(d=1/d,r*=d,a*=d,s*=d):(r=0,a=0,s=0),o=c*s-p*a,l=p*r-h*s,u=h*a-c*r,d=Math.sqrt(o*o+l*l+u*u),d?(d=1/d,o*=d,l*=d,u*=d):(o=0,l=0,u=0),i[0]=r,i[1]=o,i[2]=h,i[3]=0,i[4]=a,i[5]=l,i[6]=c,i[7]=0,i[8]=s,i[9]=u,i[10]=p,i[11]=0,i[12]=-(r*m+a*g+s*v),i[13]=-(o*m+l*g+u*v),i[14]=-(h*m+c*g+p*v),i[15]=1,i)},f.fromRotationTranslation=function(e,t,n){n||(n=f.create());var i=e[0],r=e[1],a=e[2],s=e[3],o=i+i,l=r+r,u=a+a,h=i*o,c=i*l,p=i*u,d=r*l,m=r*u,g=a*u,v=s*o,y=s*l,_=s*u;return n[0]=1-(d+g),n[1]=c+_,n[2]=p-y,n[3]=0,n[4]=c-_,n[5]=1-(h+g),n[6]=m+v,n[7]=0,n[8]=p+y,n[9]=m-v,n[10]=1-(h+d),n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n},f.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+"]"};var m={};m.create=function(e){var t=new a(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},m.createFrom=function(e,t,n,i){var r=new a(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r},m.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},m.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])&&i>Math.abs(e[2]-t[2])&&i>Math.abs(e[3]-t[3])},m.identity=function(e){return e||(e=m.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};var g=m.identity();m.calculateW=function(e,t){var n=e[0],i=e[1],r=e[2];return t&&e!==t?(t[0]=n,t[1]=i,t[2]=r,t[3]=-Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t):(e[3]=-Math.sqrt(Math.abs(1-n*n-i*i-r*r)),e)},m.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},m.inverse=function(e,t){var n=e[0],i=e[1],r=e[2],a=e[3],s=n*n+i*i+r*r+a*a,o=s?1/s:0;return t&&e!==t?(t[0]=-e[0]*o,t[1]=-e[1]*o,t[2]=-e[2]*o,t[3]=e[3]*o,t):(e[0]*=-o,e[1]*=-o,e[2]*=-o,e[3]*=o,e)},m.conjugate=function(e,t){return t&&e!==t?(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t):(e[0]*=-1,e[1]*=-1,e[2]*=-1,e)},m.length=function(e){var t=e[0],n=e[1],i=e[2],r=e[3];return Math.sqrt(t*t+n*n+i*i+r*r)},m.normalize=function(e,t){t||(t=e);var n=e[0],i=e[1],r=e[2],a=e[3],s=Math.sqrt(n*n+i*i+r*r+a*a);return 0===s?(t[0]=0,t[1]=0,t[2]=0,t[3]=0,t):(s=1/s,t[0]=n*s,t[1]=i*s,t[2]=r*s,t[3]=a*s,t)},m.add=function(e,t,n){return n&&e!==n?(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n):(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[3],e)},m.multiply=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],s=e[3],o=t[0],l=t[1],u=t[2],h=t[3];return n[0]=i*h+s*o+r*u-a*l,n[1]=r*h+s*l+a*o-i*u,n[2]=a*h+s*u+i*l-r*o,n[3]=s*h-i*o-r*l-a*u,n},m.multiplyVec3=function(e,t,n){n||(n=t);var i=t[0],r=t[1],a=t[2],s=e[0],o=e[1],l=e[2],u=e[3],h=u*i+o*a-l*r,c=u*r+l*i-s*a,p=u*a+s*r-o*i,d=-s*i-o*r-l*a;return n[0]=h*u+d*-s+c*-l-p*-o,n[1]=c*u+d*-o+p*-s-h*-l,n[2]=p*u+d*-l+h*-o-c*-s,n},m.scale=function(e,t,n){return n&&e!==n?(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n):(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e)},m.toMat3=function(e,t){t||(t=d.create());var n=e[0],i=e[1],r=e[2],a=e[3],s=n+n,o=i+i,l=r+r,u=n*s,h=n*o,c=n*l,p=i*o,f=i*l,m=r*l,g=a*s,v=a*o,y=a*l;return t[0]=1-(p+m),t[1]=h+y,t[2]=c-v,t[3]=h-y,t[4]=1-(u+m),t[5]=f+g,t[6]=c+v,t[7]=f-g,t[8]=1-(u+p),t},m.toMat4=function(e,t){t||(t=f.create());var n=e[0],i=e[1],r=e[2],a=e[3],s=n+n,o=i+i,l=r+r,u=n*s,h=n*o,c=n*l,p=i*o,d=i*l,m=r*l,g=a*s,v=a*o,y=a*l;return t[0]=1-(p+m),t[1]=h+y,t[2]=c-v,t[3]=0,t[4]=h-y,t[5]=1-(u+m),t[6]=d+g,t[7]=0,t[8]=c+v,t[9]=d-g,t[10]=1-(u+p),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},m.slerp=function(e,t,n,i){i||(i=e);var r,a,s,o,l=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],u=1;return 0>l&&(l=-l,u=-1),Math.abs(l)>=1?(i!==e&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]),i):(r=Math.acos(l),a=Math.sqrt(1-l*l),.001>Math.abs(a)?(i[0]=.5*e[0]+.5*t[0],i[1]=.5*e[1]+.5*t[1],i[2]=.5*e[2]+.5*t[2],i[3]=.5*e[3]+.5*t[3],i):(s=Math.sin((1-n)*r)/a,o=Math.sin(n*r)/a,i[0]=e[0]*s+t[0]*u*o,i[1]=e[1]*s+t[1]*u*o,i[2]=e[2]*s+t[2]*u*o,i[3]=e[3]*s+t[3]*u*o,i))},m.fromRotationMatrix=function(e,t){t||(t=m.create());var n=d.create();d.transpose(e,n);var i,r=n[0]+n[4]+n[8];if(r>0)i=Math.sqrt(r+1),t[3]=.5*i,i=.5/i,t[0]=(n[7]-n[5])*i,t[1]=(n[2]-n[6])*i,t[2]=(n[3]-n[1])*i;else{var a=m.fromRotationMatrix.s_iNext=m.fromRotationMatrix.s_iNext||[1,2,0],s=0;n[4]>n[0]&&(s=1),n[8]>n[3*s+s]&&(s=2);var o=a[s],l=a[o];i=Math.sqrt(n[3*s+s]-n[3*o+o]-n[3*l+l]+1),t[s]=.5*i,i=.5/i,t[3]=(n[3*l+o]-n[3*o+l])*i,t[o]=(n[3*o+s]+n[3*s+o])*i,t[l]=(n[3*l+s]+n[3*s+l])*i}return t},d.toQuat4=m.fromRotationMatrix,function(){var e=d.create();m.fromAxes=function(t,n,i,r){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=t[0],e[5]=t[1],e[8]=t[2],m.fromRotationMatrix(e,r)}}(),m.identity=function(e){return e||(e=m.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},m.fromAngleAxis=function(e,t,n){n||(n=m.create());var i=.5*e,r=Math.sin(i);return n[3]=Math.cos(i),n[0]=r*t[0],n[1]=r*t[1],n[2]=r*t[2],n},m.toAngleAxis=function(e,t){t||(t=e);var n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(n>0){t[3]=2*Math.acos(e[3]);var i=r.invsqrt(n);t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i}else t[3]=0,t[0]=1,t[1]=0,t[2]=0;return t},m.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var v={};v.create=function(e){var t=new a(2);return e?(t[0]=e[0],t[1]=e[1]):(t[0]=0,t[1]=0),t},v.createFrom=function(e,t){var n=new a(2);return n[0]=e,n[1]=t,n},v.add=function(e,t,n){return n||(n=t),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n},v.subtract=function(e,t,n){return n||(n=t),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n},v.multiply=function(e,t,n){return n||(n=t),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n},v.divide=function(e,t,n){return n||(n=t),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n},v.scale=function(e,t,n){return n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n},v.dist=function(e,t){var n=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(n*n+i*i)},v.set=function(e,t){return t[0]=e[0],t[1]=e[1],t},v.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])},v.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t},v.normalize=function(e,t){t||(t=e);var n=e[0]*e[0]+e[1]*e[1];return n>0?(n=Math.sqrt(n),t[0]=e[0]/n,t[1]=e[1]/n):t[0]=t[1]=0,t},v.cross=function(e,t,n){var i=e[0]*t[1]-e[1]*t[0];return n?(n[0]=n[1]=0,n[2]=i,n):i},v.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},v.squaredLength=function(e){var t=e[0],n=e[1];return t*t+n*n},v.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},v.direction=function(e,t,n){n||(n=e);var i=e[0]-t[0],r=e[1]-t[1],a=i*i+r*r;return a?(a=1/Math.sqrt(a),n[0]=i*a,n[1]=r*a,n):(n[0]=0,n[1]=0,n[2]=0,n)},v.lerp=function(e,t,n,i){return i||(i=e),i[0]=e[0]+n*(t[0]-e[0]),i[1]=e[1]+n*(t[1]-e[1]),i},v.str=function(e){return"["+e[0]+", "+e[1]+"]"};var y={};y.create=function(e){var t=new a(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},y.createFrom=function(e,t,n,i){var r=new a(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r},y.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},y.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])&&i>Math.abs(e[2]-t[2])&&i>Math.abs(e[3]-t[3])},y.identity=function(e){return e||(e=y.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},y.transpose=function(e,t){if(!t||e===t){var n=e[1];return e[1]=e[2],e[2]=n,e}return t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t},y.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},y.inverse=function(e,t){t||(t=e);var n=e[0],i=e[1],r=e[2],a=e[3],s=n*a-r*i;return s?(s=1/s,t[0]=a*s,t[1]=-i*s,t[2]=-r*s,t[3]=n*s,t):null},y.multiply=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],s=e[3];return n[0]=i*t[0]+r*t[2],n[1]=i*t[1]+r*t[3],n[2]=a*t[0]+s*t[2],n[3]=a*t[1]+s*t[3],n},y.rotate=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],s=e[3],o=Math.sin(t),l=Math.cos(t);return n[0]=i*l+r*o,n[1]=i*-o+r*l,n[2]=a*l+s*o,n[3]=a*-o+s*l,n},y.multiplyVec2=function(e,t,n){n||(n=t);var i=t[0],r=t[1];return n[0]=i*e[0]+r*e[1],n[1]=i*e[2]+r*e[3],n},y.scale=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],s=e[3],o=t[0],l=t[1];return n[0]=i*o,n[1]=r*l,n[2]=a*o,n[3]=s*l,n},y.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var _={};return _.create=function(e){var t=new a(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t},_.createFrom=function(e,t,n,i){var r=new a(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r},_.add=function(e,t,n){return n||(n=t),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},_.subtract=function(e,t,n){return n||(n=t),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n},_.multiply=function(e,t,n){return n||(n=t),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n[3]=e[3]*t[3],n},_.divide=function(e,t,n){return n||(n=t),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n[3]=e[3]/t[3],n},_.scale=function(e,t,n){return n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},_.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},_.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])&&i>Math.abs(e[2]-t[2])&&i>Math.abs(e[3]-t[3])},_.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},_.length=function(e){var t=e[0],n=e[1],i=e[2],r=e[3];return Math.sqrt(t*t+n*n+i*i+r*r)},_.squaredLength=function(e){var t=e[0],n=e[1],i=e[2],r=e[3];return t*t+n*n+i*i+r*r},_.lerp=function(e,t,n,i){return i||(i=e),i[0]=e[0]+n*(t[0]-e[0]),i[1]=e[1]+n*(t[1]-e[1]),i[2]=e[2]+n*(t[2]-e[2]),i[3]=e[3]+n*(t[3]-e[3]),i},_.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"},e&&(e.glMatrixArrayType=a,e.MatrixArray=a,e.setMatrixArrayType=t,e.determineMatrixArrayType=n,e.glMath=r,e.vec2=v,e.vec3=s,e.vec4=_,e.mat2=y,e.mat3=d,e.mat4=f,e.quat4=m),{glMatrixArrayType:a,MatrixArray:a,setMatrixArrayType:t,determineMatrixArrayType:n,glMath:r,vec2:v,vec3:s,vec4:_,mat2:y,mat3:d,mat4:f,quat4:m}});