var global=window;(function(e,t){"object"==typeof exports?module.exports=t(global):"function"==typeof define&&define.amd?define([],function(){return t(e)}):t(e)})(this,function(e){"use strict";function t(e){return a=e}function n(){return a="undefined"!=typeof Float32Array?Float32Array:Array}var i=1e-6,r={};(function(){if("undefined"!=typeof Float32Array){var e=new Float32Array(1),t=new Int32Array(e.buffer);r.invsqrt=function(n){var i=.5*n;e[0]=n;var r=1.5;t[0]=1597463007-(t[0]>>1);var a=e[0];return a*(r-i*a*a)}}else r.invsqrt=function(e){return 1/Math.sqrt(e)}})();var a=null;n();var o={};o.create=function(e){var t=new a(3);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2]):t[0]=t[1]=t[2]=0,t},o.createFrom=function(e,t,n){var i=new a(3);return i[0]=e,i[1]=t,i[2]=n,i},o.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t},o.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])&&i>Math.abs(e[2]-t[2])},o.add=function(e,t,n){return n&&e!==n?(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n):(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e)},o.subtract=function(e,t,n){return n&&e!==n?(n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n):(e[0]-=t[0],e[1]-=t[1],e[2]-=t[2],e)},o.multiply=function(e,t,n){return n&&e!==n?(n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n):(e[0]*=t[0],e[1]*=t[1],e[2]*=t[2],e)},o.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t},o.scale=function(e,t,n){return n&&e!==n?(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n):(e[0]*=t,e[1]*=t,e[2]*=t,e)},o.normalize=function(e,t){t||(t=e);var n=e[0],i=e[1],r=e[2],a=Math.sqrt(n*n+i*i+r*r);return a?1===a?(t[0]=n,t[1]=i,t[2]=r,t):(a=1/a,t[0]=n*a,t[1]=i*a,t[2]=r*a,t):(t[0]=0,t[1]=0,t[2]=0,t)},o.cross=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],o=t[0],s=t[1],l=t[2];return n[0]=r*l-a*s,n[1]=a*o-i*l,n[2]=i*s-r*o,n},o.length=function(e){var t=e[0],n=e[1],i=e[2];return Math.sqrt(t*t+n*n+i*i)},o.squaredLength=function(e){var t=e[0],n=e[1],i=e[2];return t*t+n*n+i*i},o.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]},o.direction=function(e,t,n){n||(n=e);var i=e[0]-t[0],r=e[1]-t[1],a=e[2]-t[2],o=Math.sqrt(i*i+r*r+a*a);return o?(o=1/o,n[0]=i*o,n[1]=r*o,n[2]=a*o,n):(n[0]=0,n[1]=0,n[2]=0,n)},o.lerp=function(e,t,n,i){return i||(i=e),i[0]=e[0]+n*(t[0]-e[0]),i[1]=e[1]+n*(t[1]-e[1]),i[2]=e[2]+n*(t[2]-e[2]),i},o.dist=function(e,t){var n=t[0]-e[0],i=t[1]-e[1],r=t[2]-e[2];return Math.sqrt(n*n+i*i+r*r)};var s=null,l=new a(4);o.unproject=function(e,t,n,i,r){r||(r=e),s||(s=m.create());var a=s,o=l;return o[0]=2*(e[0]-i[0])/i[2]-1,o[1]=2*(e[1]-i[1])/i[3]-1,o[2]=2*e[2]-1,o[3]=1,m.multiply(n,t,a),m.inverse(a)?(m.multiplyVec4(a,o),0===o[3]?null:(r[0]=o[0]/o[3],r[1]=o[1]/o[3],r[2]=o[2]/o[3],r)):null};var u=o.createFrom(1,0,0),c=o.createFrom(0,1,0),h=o.createFrom(0,0,1),d=o.create();o.rotationTo=function(e,t,n){n||(n=f.create());var i=o.dot(e,t),r=d;if(i>=1)f.set(v,n);else if(1e-6-1>i)o.cross(u,e,r),1e-6>o.length(r)&&o.cross(c,e,r),1e-6>o.length(r)&&o.cross(h,e,r),o.normalize(r),f.fromAngleAxis(Math.PI,r,n);else{var a=Math.sqrt(2*(1+i)),s=1/a;o.cross(e,t,r),n[0]=r[0]*s,n[1]=r[1]*s,n[2]=r[2]*s,n[3]=.5*a,f.normalize(n)}return n[3]>1?n[3]=1:-1>n[3]&&(n[3]=-1),n},o.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+"]"};var p={};p.create=function(e){var t=new a(9);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8]):t[0]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=0,t},p.createFrom=function(e,t,n,i,r,o,s,l,u){var c=new a(9);return c[0]=e,c[1]=t,c[2]=n,c[3]=i,c[4]=r,c[5]=o,c[6]=s,c[7]=l,c[8]=u,c},p.determinant=function(e){var t=e[0],n=e[1],i=e[2],r=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8];return t*(u*a-o*l)+n*(-u*r+o*s)+i*(l*r-a*s)},p.inverse=function(e,t){var n,i=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=h*s-l*c,m=-h*o+l*u,f=c*o-s*u,v=i*d+r*m+a*f;return v?(n=1/v,t||(t=p.create()),t[0]=d*n,t[1]=(-h*r+a*c)*n,t[2]=(l*r-a*s)*n,t[3]=m*n,t[4]=(h*i-a*u)*n,t[5]=(-l*i+a*o)*n,t[6]=f*n,t[7]=(-c*i+r*u)*n,t[8]=(s*i-r*o)*n,t):null},p.multiply=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=t[0],p=t[1],m=t[2],f=t[3],v=t[4],g=t[5],_=t[6],b=t[7],y=t[8];return n[0]=d*i+p*o+m*u,n[1]=d*r+p*s+m*c,n[2]=d*a+p*l+m*h,n[3]=f*i+v*o+g*u,n[4]=f*r+v*s+g*c,n[5]=f*a+v*l+g*h,n[6]=_*i+b*o+y*u,n[7]=_*r+b*s+y*c,n[8]=_*a+b*l+y*h,n},p.multiplyVec2=function(e,t,n){n||(n=t);var i=t[0],r=t[1];return n[0]=i*e[0]+r*e[3]+e[6],n[1]=i*e[1]+r*e[4]+e[7],n},p.multiplyVec3=function(e,t,n){n||(n=t);var i=t[0],r=t[1],a=t[2];return n[0]=i*e[0]+r*e[3]+a*e[6],n[1]=i*e[1]+r*e[4]+a*e[7],n[2]=i*e[2]+r*e[5]+a*e[8],n},p.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t},p.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])&&i>Math.abs(e[2]-t[2])&&i>Math.abs(e[3]-t[3])&&i>Math.abs(e[4]-t[4])&&i>Math.abs(e[5]-t[5])&&i>Math.abs(e[6]-t[6])&&i>Math.abs(e[7]-t[7])&&i>Math.abs(e[8]-t[8])},p.identity=function(e){return e||(e=p.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=1,e[5]=0,e[6]=0,e[7]=0,e[8]=1,e},p.transpose=function(e,t){if(!t||e===t){var n=e[1],i=e[2],r=e[5];return e[1]=e[3],e[2]=e[6],e[3]=n,e[5]=e[7],e[6]=i,e[7]=r,e}return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],t},p.toMat4=function(e,t){return t||(t=m.create()),t[15]=1,t[14]=0,t[13]=0,t[12]=0,t[11]=0,t[10]=e[8],t[9]=e[7],t[8]=e[6],t[7]=0,t[6]=e[5],t[5]=e[4],t[4]=e[3],t[3]=0,t[2]=e[2],t[1]=e[1],t[0]=e[0],t},p.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+"]"};var m={};m.create=function(e){var t=new a(16);return e&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t},m.createFrom=function(e,t,n,i,r,o,s,l,u,c,h,d,p,m,f,v){var g=new a(16);return g[0]=e,g[1]=t,g[2]=n,g[3]=i,g[4]=r,g[5]=o,g[6]=s,g[7]=l,g[8]=u,g[9]=c,g[10]=h,g[11]=d,g[12]=p,g[13]=m,g[14]=f,g[15]=v,g},m.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t},m.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])&&i>Math.abs(e[2]-t[2])&&i>Math.abs(e[3]-t[3])&&i>Math.abs(e[4]-t[4])&&i>Math.abs(e[5]-t[5])&&i>Math.abs(e[6]-t[6])&&i>Math.abs(e[7]-t[7])&&i>Math.abs(e[8]-t[8])&&i>Math.abs(e[9]-t[9])&&i>Math.abs(e[10]-t[10])&&i>Math.abs(e[11]-t[11])&&i>Math.abs(e[12]-t[12])&&i>Math.abs(e[13]-t[13])&&i>Math.abs(e[14]-t[14])&&i>Math.abs(e[15]-t[15])},m.identity=function(e){return e||(e=m.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},m.transpose=function(e,t){if(!t||e===t){var n=e[1],i=e[2],r=e[3],a=e[6],o=e[7],s=e[11];return e[1]=e[4],e[2]=e[8],e[3]=e[12],e[4]=n,e[6]=e[9],e[7]=e[13],e[8]=i,e[9]=a,e[11]=e[14],e[12]=r,e[13]=o,e[14]=s,e}return t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15],t},m.determinant=function(e){var t=e[0],n=e[1],i=e[2],r=e[3],a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11],p=e[12],m=e[13],f=e[14],v=e[15];return p*c*s*r-u*m*s*r-p*o*h*r+a*m*h*r+u*o*f*r-a*c*f*r-p*c*i*l+u*m*i*l+p*n*h*l-t*m*h*l-u*n*f*l+t*c*f*l+p*o*i*d-a*m*i*d-p*n*s*d+t*m*s*d+a*n*f*d-t*o*f*d-u*o*i*v+a*c*i*v+u*n*s*v-t*c*s*v-a*n*h*v+t*o*h*v},m.inverse=function(e,t){t||(t=e);var n,i=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],m=e[11],f=e[12],v=e[13],g=e[14],_=e[15],b=i*l-r*s,y=i*u-a*s,w=i*c-o*s,C=r*u-a*l,S=r*c-o*l,E=a*c-o*u,T=h*v-d*f,P=h*g-p*f,x=h*_-m*f,M=d*g-p*v,O=d*_-m*v,D=p*_-m*g,L=b*D-y*O+w*M+C*x-S*P+E*T;return L?(n=1/L,t[0]=(l*D-u*O+c*M)*n,t[1]=(-r*D+a*O-o*M)*n,t[2]=(v*E-g*S+_*C)*n,t[3]=(-d*E+p*S-m*C)*n,t[4]=(-s*D+u*x-c*P)*n,t[5]=(i*D-a*x+o*P)*n,t[6]=(-f*E+g*w-_*y)*n,t[7]=(h*E-p*w+m*y)*n,t[8]=(s*O-l*x+c*T)*n,t[9]=(-i*O+r*x-o*T)*n,t[10]=(f*S-v*w+_*b)*n,t[11]=(-h*S+d*w-m*b)*n,t[12]=(-s*M+l*P-u*T)*n,t[13]=(i*M-r*P+a*T)*n,t[14]=(-f*C+v*y-g*b)*n,t[15]=(h*C-d*y+p*b)*n,t):null},m.toRotationMat=function(e,t){return t||(t=m.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},m.toMat3=function(e,t){return t||(t=p.create()),t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t},m.toInverseMat3=function(e,t){var n,i=e[0],r=e[1],a=e[2],o=e[4],s=e[5],l=e[6],u=e[8],c=e[9],h=e[10],d=h*s-l*c,m=-h*o+l*u,f=c*o-s*u,v=i*d+r*m+a*f;return v?(n=1/v,t||(t=p.create()),t[0]=d*n,t[1]=(-h*r+a*c)*n,t[2]=(l*r-a*s)*n,t[3]=m*n,t[4]=(h*i-a*u)*n,t[5]=(-l*i+a*o)*n,t[6]=f*n,t[7]=(-c*i+r*u)*n,t[8]=(s*i-r*o)*n,t):null},m.multiply=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],m=e[11],f=e[12],v=e[13],g=e[14],_=e[15],b=t[0],y=t[1],w=t[2],C=t[3];return n[0]=b*i+y*s+w*h+C*f,n[1]=b*r+y*l+w*d+C*v,n[2]=b*a+y*u+w*p+C*g,n[3]=b*o+y*c+w*m+C*_,b=t[4],y=t[5],w=t[6],C=t[7],n[4]=b*i+y*s+w*h+C*f,n[5]=b*r+y*l+w*d+C*v,n[6]=b*a+y*u+w*p+C*g,n[7]=b*o+y*c+w*m+C*_,b=t[8],y=t[9],w=t[10],C=t[11],n[8]=b*i+y*s+w*h+C*f,n[9]=b*r+y*l+w*d+C*v,n[10]=b*a+y*u+w*p+C*g,n[11]=b*o+y*c+w*m+C*_,b=t[12],y=t[13],w=t[14],C=t[15],n[12]=b*i+y*s+w*h+C*f,n[13]=b*r+y*l+w*d+C*v,n[14]=b*a+y*u+w*p+C*g,n[15]=b*o+y*c+w*m+C*_,n},m.multiply3=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],m=e[11],f=e[12],v=e[13],g=e[14],_=e[15],b=t[0],y=t[1],w=t[2],C=0;return n[0]=b*i+y*s+w*h+C*f,n[1]=b*r+y*l+w*d+C*v,n[2]=b*a+y*u+w*p+C*g,n[3]=b*o+y*c+w*m+C*_,b=t[4],y=t[5],w=t[6],C=0,n[4]=b*i+y*s+w*h+C*f,n[5]=b*r+y*l+w*d+C*v,n[6]=b*a+y*u+w*p+C*g,n[7]=b*o+y*c+w*m+C*_,b=t[8],y=t[9],w=t[10],C=0,n[8]=b*i+y*s+w*h+C*f,n[9]=b*r+y*l+w*d+C*v,n[10]=b*a+y*u+w*p+C*g,n[11]=b*o+y*c+w*m+C*_,n},m.multiplyVec3=function(e,t,n){n||(n=t);var i=t[0],r=t[1],a=t[2];return n[0]=e[0]*i+e[4]*r+e[8]*a+e[12],n[1]=e[1]*i+e[5]*r+e[9]*a+e[13],n[2]=e[2]*i+e[6]*r+e[10]*a+e[14],n},m.rotateVec3=function(e,t,n){n||(n=t);var i=t[0],r=t[1],a=t[2];return n[0]=e[0]*i+e[4]*r+e[8]*a,n[1]=e[1]*i+e[5]*r+e[9]*a,n[2]=e[2]*i+e[6]*r+e[10]*a,n},m.multiplyVec4=function(e,t,n){n||(n=t);var i=t[0],r=t[1],a=t[2],o=t[3];return n[0]=e[0]*i+e[4]*r+e[8]*a+e[12]*o,n[1]=e[1]*i+e[5]*r+e[9]*a+e[13]*o,n[2]=e[2]*i+e[6]*r+e[10]*a+e[14]*o,n[3]=e[3]*i+e[7]*r+e[11]*a+e[15]*o,n},m.translate=function(e,t,n){var i,r,a,o,s,l,u,c,h,d,p,m,f=t[0],v=t[1],g=t[2];return n&&e!==n?(i=e[0],r=e[1],a=e[2],o=e[3],s=e[4],l=e[5],u=e[6],c=e[7],h=e[8],d=e[9],p=e[10],m=e[11],n[0]=i,n[1]=r,n[2]=a,n[3]=o,n[4]=s,n[5]=l,n[6]=u,n[7]=c,n[8]=h,n[9]=d,n[10]=p,n[11]=m,n[12]=i*f+s*v+h*g+e[12],n[13]=r*f+l*v+d*g+e[13],n[14]=a*f+u*v+p*g+e[14],n[15]=o*f+c*v+m*g+e[15],n):(e[12]=e[0]*f+e[4]*v+e[8]*g+e[12],e[13]=e[1]*f+e[5]*v+e[9]*g+e[13],e[14]=e[2]*f+e[6]*v+e[10]*g+e[14],e[15]=e[3]*f+e[7]*v+e[11]*g+e[15],e)},m.scale=function(e,t,n){var i=t[0],r=t[1],a=t[2];return n&&e!==n?(n[0]=e[0]*i,n[1]=e[1]*i,n[2]=e[2]*i,n[3]=e[3]*i,n[4]=e[4]*r,n[5]=e[5]*r,n[6]=e[6]*r,n[7]=e[7]*r,n[8]=e[8]*a,n[9]=e[9]*a,n[10]=e[10]*a,n[11]=e[11]*a,n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15],n):(e[0]*=i,e[1]*=i,e[2]*=i,e[3]*=i,e[4]*=r,e[5]*=r,e[6]*=r,e[7]*=r,e[8]*=a,e[9]*=a,e[10]*=a,e[11]*=a,e)},m.rotate=function(e,t,n,i){var r,a,o,s,l,u,c,h,d,p,m,f,v,g,_,b,y,w,C,S,E,T,P,x,M=n[0],O=n[1],D=n[2],L=Math.sqrt(M*M+O*O+D*D);return L?(1!==L&&(L=1/L,M*=L,O*=L,D*=L),r=Math.sin(t),a=Math.cos(t),o=1-a,s=e[0],l=e[1],u=e[2],c=e[3],h=e[4],d=e[5],p=e[6],m=e[7],f=e[8],v=e[9],g=e[10],_=e[11],b=M*M*o+a,y=O*M*o+D*r,w=D*M*o-O*r,C=M*O*o-D*r,S=O*O*o+a,E=D*O*o+M*r,T=M*D*o+O*r,P=O*D*o-M*r,x=D*D*o+a,i?e!==i&&(i[12]=e[12],i[13]=e[13],i[14]=e[14],i[15]=e[15]):i=e,i[0]=s*b+h*y+f*w,i[1]=l*b+d*y+v*w,i[2]=u*b+p*y+g*w,i[3]=c*b+m*y+_*w,i[4]=s*C+h*S+f*E,i[5]=l*C+d*S+v*E,i[6]=u*C+p*S+g*E,i[7]=c*C+m*S+_*E,i[8]=s*T+h*P+f*x,i[9]=l*T+d*P+v*x,i[10]=u*T+p*P+g*x,i[11]=c*T+m*P+_*x,i):null},m.rotateX=function(e,t,n){var i=Math.sin(t),r=Math.cos(t),a=e[4],o=e[5],s=e[6],l=e[7],u=e[8],c=e[9],h=e[10],d=e[11];return n?e!==n&&(n[0]=e[0],n[1]=e[1],n[2]=e[2],n[3]=e[3],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[4]=a*r+u*i,n[5]=o*r+c*i,n[6]=s*r+h*i,n[7]=l*r+d*i,n[8]=a*-i+u*r,n[9]=o*-i+c*r,n[10]=s*-i+h*r,n[11]=l*-i+d*r,n},m.rotateY=function(e,t,n){var i=Math.sin(t),r=Math.cos(t),a=e[0],o=e[1],s=e[2],l=e[3],u=e[8],c=e[9],h=e[10],d=e[11];return n?e!==n&&(n[4]=e[4],n[5]=e[5],n[6]=e[6],n[7]=e[7],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=a*r+u*-i,n[1]=o*r+c*-i,n[2]=s*r+h*-i,n[3]=l*r+d*-i,n[8]=a*i+u*r,n[9]=o*i+c*r,n[10]=s*i+h*r,n[11]=l*i+d*r,n},m.rotateZ=function(e,t,n){var i=Math.sin(t),r=Math.cos(t),a=e[0],o=e[1],s=e[2],l=e[3],u=e[4],c=e[5],h=e[6],d=e[7];return n?e!==n&&(n[8]=e[8],n[9]=e[9],n[10]=e[10],n[11]=e[11],n[12]=e[12],n[13]=e[13],n[14]=e[14],n[15]=e[15]):n=e,n[0]=a*r+u*i,n[1]=o*r+c*i,n[2]=s*r+h*i,n[3]=l*r+d*i,n[4]=a*-i+u*r,n[5]=o*-i+c*r,n[6]=s*-i+h*r,n[7]=l*-i+d*r,n},m.frustum=function(e,t,n,i,r,a,o){o||(o=m.create());var s=t-e,l=i-n,u=a-r;return o[0]=2*r/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2*r/l,o[6]=0,o[7]=0,o[8]=(t+e)/s,o[9]=(i+n)/l,o[10]=-(a+r)/u,o[11]=-1,o[12]=0,o[13]=0,o[14]=-(2*a*r)/u,o[15]=0,o},m.perspective=function(e,t,n,i,r){var a=n*Math.tan(e*Math.PI/360),o=a*t;return m.frustum(-o,o,-a,a,n,i,r)},m.ortho=function(e,t,n,i,r,a,o){o||(o=m.create());var s=t-e,l=i-n,u=a-r;return o[0]=2/s,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=2/l,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=-2/u,o[11]=0,o[12]=-(e+t)/s,o[13]=-(i+n)/l,o[14]=-(a+r)/u,o[15]=1,o},m.lookAt=function(e,t,n,i){i||(i=m.create());var r,a,o,s,l,u,c,h,d,p,f=e[0],v=e[1],g=e[2],_=n[0],b=n[1],y=n[2],w=t[0],C=t[1],S=t[2];return f===w&&v===C&&g===S?m.identity(i):(c=f-w,h=v-C,d=g-S,p=1/Math.sqrt(c*c+h*h+d*d),c*=p,h*=p,d*=p,r=b*d-y*h,a=y*c-_*d,o=_*h-b*c,p=Math.sqrt(r*r+a*a+o*o),p?(p=1/p,r*=p,a*=p,o*=p):(r=0,a=0,o=0),s=h*o-d*a,l=d*r-c*o,u=c*a-h*r,p=Math.sqrt(s*s+l*l+u*u),p?(p=1/p,s*=p,l*=p,u*=p):(s=0,l=0,u=0),i[0]=r,i[1]=s,i[2]=c,i[3]=0,i[4]=a,i[5]=l,i[6]=h,i[7]=0,i[8]=o,i[9]=u,i[10]=d,i[11]=0,i[12]=-(r*f+a*v+o*g),i[13]=-(s*f+l*v+u*g),i[14]=-(c*f+h*v+d*g),i[15]=1,i)},m.fromRotationTranslation=function(e,t,n){n||(n=m.create());var i=e[0],r=e[1],a=e[2],o=e[3],s=i+i,l=r+r,u=a+a,c=i*s,h=i*l,d=i*u,p=r*l,f=r*u,v=a*u,g=o*s,_=o*l,b=o*u;return n[0]=1-(p+v),n[1]=h+b,n[2]=d-_,n[3]=0,n[4]=h-b,n[5]=1-(c+v),n[6]=f+g,n[7]=0,n[8]=d+_,n[9]=f-g,n[10]=1-(c+p),n[11]=0,n[12]=t[0],n[13]=t[1],n[14]=t[2],n[15]=1,n},m.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+", "+e[4]+", "+e[5]+", "+e[6]+", "+e[7]+", "+e[8]+", "+e[9]+", "+e[10]+", "+e[11]+", "+e[12]+", "+e[13]+", "+e[14]+", "+e[15]+"]"};var f={};f.create=function(e){var t=new a(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},f.createFrom=function(e,t,n,i){var r=new a(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r},f.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},f.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])&&i>Math.abs(e[2]-t[2])&&i>Math.abs(e[3]-t[3])},f.identity=function(e){return e||(e=f.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e};var v=f.identity();f.calculateW=function(e,t){var n=e[0],i=e[1],r=e[2];return t&&e!==t?(t[0]=n,t[1]=i,t[2]=r,t[3]=-Math.sqrt(Math.abs(1-n*n-i*i-r*r)),t):(e[3]=-Math.sqrt(Math.abs(1-n*n-i*i-r*r)),e)},f.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]},f.inverse=function(e,t){var n=e[0],i=e[1],r=e[2],a=e[3],o=n*n+i*i+r*r+a*a,s=o?1/o:0;return t&&e!==t?(t[0]=-e[0]*s,t[1]=-e[1]*s,t[2]=-e[2]*s,t[3]=e[3]*s,t):(e[0]*=-s,e[1]*=-s,e[2]*=-s,e[3]*=s,e)},f.conjugate=function(e,t){return t&&e!==t?(t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t):(e[0]*=-1,e[1]*=-1,e[2]*=-1,e)},f.length=function(e){var t=e[0],n=e[1],i=e[2],r=e[3];return Math.sqrt(t*t+n*n+i*i+r*r)},f.normalize=function(e,t){t||(t=e);var n=e[0],i=e[1],r=e[2],a=e[3],o=Math.sqrt(n*n+i*i+r*r+a*a);return 0===o?(t[0]=0,t[1]=0,t[2]=0,t[3]=0,t):(o=1/o,t[0]=n*o,t[1]=i*o,t[2]=r*o,t[3]=a*o,t)},f.add=function(e,t,n){return n&&e!==n?(n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n):(e[0]+=t[0],e[1]+=t[1],e[2]+=t[2],e[3]+=t[3],e)},f.multiply=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],o=e[3],s=t[0],l=t[1],u=t[2],c=t[3];return n[0]=i*c+o*s+r*u-a*l,n[1]=r*c+o*l+a*s-i*u,n[2]=a*c+o*u+i*l-r*s,n[3]=o*c-i*s-r*l-a*u,n},f.multiplyVec3=function(e,t,n){n||(n=t);var i=t[0],r=t[1],a=t[2],o=e[0],s=e[1],l=e[2],u=e[3],c=u*i+s*a-l*r,h=u*r+l*i-o*a,d=u*a+o*r-s*i,p=-o*i-s*r-l*a;return n[0]=c*u+p*-o+h*-l-d*-s,n[1]=h*u+p*-s+d*-o-c*-l,n[2]=d*u+p*-l+c*-s-h*-o,n},f.scale=function(e,t,n){return n&&e!==n?(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n):(e[0]*=t,e[1]*=t,e[2]*=t,e[3]*=t,e)},f.toMat3=function(e,t){t||(t=p.create());var n=e[0],i=e[1],r=e[2],a=e[3],o=n+n,s=i+i,l=r+r,u=n*o,c=n*s,h=n*l,d=i*s,m=i*l,f=r*l,v=a*o,g=a*s,_=a*l;return t[0]=1-(d+f),t[1]=c+_,t[2]=h-g,t[3]=c-_,t[4]=1-(u+f),t[5]=m+v,t[6]=h+g,t[7]=m-v,t[8]=1-(u+d),t},f.toMat4=function(e,t){t||(t=m.create());var n=e[0],i=e[1],r=e[2],a=e[3],o=n+n,s=i+i,l=r+r,u=n*o,c=n*s,h=n*l,d=i*s,p=i*l,f=r*l,v=a*o,g=a*s,_=a*l;return t[0]=1-(d+f),t[1]=c+_,t[2]=h-g,t[3]=0,t[4]=c-_,t[5]=1-(u+f),t[6]=p+v,t[7]=0,t[8]=h+g,t[9]=p-v,t[10]=1-(u+d),t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t},f.slerp=function(e,t,n,i){i||(i=e);var r,a,o,s,l=e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3],u=1;return 0>l&&(l=-l,u=-1),Math.abs(l)>=1?(i!==e&&(i[0]=e[0],i[1]=e[1],i[2]=e[2],i[3]=e[3]),i):(r=Math.acos(l),a=Math.sqrt(1-l*l),.001>Math.abs(a)?(i[0]=.5*e[0]+.5*t[0],i[1]=.5*e[1]+.5*t[1],i[2]=.5*e[2]+.5*t[2],i[3]=.5*e[3]+.5*t[3],i):(o=Math.sin((1-n)*r)/a,s=Math.sin(n*r)/a,i[0]=e[0]*o+t[0]*u*s,i[1]=e[1]*o+t[1]*u*s,i[2]=e[2]*o+t[2]*u*s,i[3]=e[3]*o+t[3]*u*s,i))},f.fromRotationMatrix=function(e,t){t||(t=f.create());var n=p.create();p.transpose(e,n);var i,r=n[0]+n[4]+n[8];if(r>0)i=Math.sqrt(r+1),t[3]=.5*i,i=.5/i,t[0]=(n[7]-n[5])*i,t[1]=(n[2]-n[6])*i,t[2]=(n[3]-n[1])*i;else{var a=f.fromRotationMatrix.s_iNext=f.fromRotationMatrix.s_iNext||[1,2,0],o=0;n[4]>n[0]&&(o=1),n[8]>n[3*o+o]&&(o=2);var s=a[o],l=a[s];i=Math.sqrt(n[3*o+o]-n[3*s+s]-n[3*l+l]+1),t[o]=.5*i,i=.5/i,t[3]=(n[3*l+s]-n[3*s+l])*i,t[s]=(n[3*s+o]+n[3*o+s])*i,t[l]=(n[3*l+o]+n[3*o+l])*i}return t},p.toQuat4=f.fromRotationMatrix,function(){var e=p.create();f.fromAxes=function(t,n,i,r){return e[0]=n[0],e[3]=n[1],e[6]=n[2],e[1]=i[0],e[4]=i[1],e[7]=i[2],e[2]=t[0],e[5]=t[1],e[8]=t[2],f.fromRotationMatrix(e,r)}}(),f.identity=function(e){return e||(e=f.create()),e[0]=0,e[1]=0,e[2]=0,e[3]=1,e},f.fromAngleAxis=function(e,t,n){n||(n=f.create());var i=.5*e,r=Math.sin(i);return n[3]=Math.cos(i),n[0]=r*t[0],n[1]=r*t[1],n[2]=r*t[2],n},f.toAngleAxis=function(e,t){t||(t=e);var n=e[0]*e[0]+e[1]*e[1]+e[2]*e[2];if(n>0){t[3]=2*Math.acos(e[3]);var i=r.invsqrt(n);t[0]=e[0]*i,t[1]=e[1]*i,t[2]=e[2]*i}else t[3]=0,t[0]=1,t[1]=0,t[2]=0;return t},f.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var g={};g.create=function(e){var t=new a(2);return e?(t[0]=e[0],t[1]=e[1]):(t[0]=0,t[1]=0),t},g.createFrom=function(e,t){var n=new a(2);return n[0]=e,n[1]=t,n},g.add=function(e,t,n){return n||(n=t),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n},g.subtract=function(e,t,n){return n||(n=t),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n},g.multiply=function(e,t,n){return n||(n=t),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n},g.divide=function(e,t,n){return n||(n=t),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n},g.scale=function(e,t,n){return n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n},g.dist=function(e,t){var n=t[0]-e[0],i=t[1]-e[1];return Math.sqrt(n*n+i*i)},g.set=function(e,t){return t[0]=e[0],t[1]=e[1],t},g.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])},g.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t},g.normalize=function(e,t){t||(t=e);var n=e[0]*e[0]+e[1]*e[1];return n>0?(n=Math.sqrt(n),t[0]=e[0]/n,t[1]=e[1]/n):t[0]=t[1]=0,t},g.cross=function(e,t,n){var i=e[0]*t[1]-e[1]*t[0];return n?(n[0]=n[1]=0,n[2]=i,n):i},g.length=function(e){var t=e[0],n=e[1];return Math.sqrt(t*t+n*n)},g.squaredLength=function(e){var t=e[0],n=e[1];return t*t+n*n},g.dot=function(e,t){return e[0]*t[0]+e[1]*t[1]},g.direction=function(e,t,n){n||(n=e);var i=e[0]-t[0],r=e[1]-t[1],a=i*i+r*r;return a?(a=1/Math.sqrt(a),n[0]=i*a,n[1]=r*a,n):(n[0]=0,n[1]=0,n[2]=0,n)},g.lerp=function(e,t,n,i){return i||(i=e),i[0]=e[0]+n*(t[0]-e[0]),i[1]=e[1]+n*(t[1]-e[1]),i},g.str=function(e){return"["+e[0]+", "+e[1]+"]"};var _={};_.create=function(e){var t=new a(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):t[0]=t[1]=t[2]=t[3]=0,t},_.createFrom=function(e,t,n,i){var r=new a(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r},_.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},_.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])&&i>Math.abs(e[2]-t[2])&&i>Math.abs(e[3]-t[3])},_.identity=function(e){return e||(e=_.create()),e[0]=1,e[1]=0,e[2]=0,e[3]=1,e},_.transpose=function(e,t){if(!t||e===t){var n=e[1];return e[1]=e[2],e[2]=n,e}return t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3],t},_.determinant=function(e){return e[0]*e[3]-e[2]*e[1]},_.inverse=function(e,t){t||(t=e);var n=e[0],i=e[1],r=e[2],a=e[3],o=n*a-r*i;return o?(o=1/o,t[0]=a*o,t[1]=-i*o,t[2]=-r*o,t[3]=n*o,t):null},_.multiply=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],o=e[3];return n[0]=i*t[0]+r*t[2],n[1]=i*t[1]+r*t[3],n[2]=a*t[0]+o*t[2],n[3]=a*t[1]+o*t[3],n},_.rotate=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],o=e[3],s=Math.sin(t),l=Math.cos(t);return n[0]=i*l+r*s,n[1]=i*-s+r*l,n[2]=a*l+o*s,n[3]=a*-s+o*l,n},_.multiplyVec2=function(e,t,n){n||(n=t);var i=t[0],r=t[1];return n[0]=i*e[0]+r*e[1],n[1]=i*e[2]+r*e[3],n},_.scale=function(e,t,n){n||(n=e);var i=e[0],r=e[1],a=e[2],o=e[3],s=t[0],l=t[1];return n[0]=i*s,n[1]=r*l,n[2]=a*s,n[3]=o*l,n},_.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"};var b={};return b.create=function(e){var t=new a(4);return e?(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3]):(t[0]=0,t[1]=0,t[2]=0,t[3]=0),t},b.createFrom=function(e,t,n,i){var r=new a(4);return r[0]=e,r[1]=t,r[2]=n,r[3]=i,r},b.add=function(e,t,n){return n||(n=t),n[0]=e[0]+t[0],n[1]=e[1]+t[1],n[2]=e[2]+t[2],n[3]=e[3]+t[3],n},b.subtract=function(e,t,n){return n||(n=t),n[0]=e[0]-t[0],n[1]=e[1]-t[1],n[2]=e[2]-t[2],n[3]=e[3]-t[3],n},b.multiply=function(e,t,n){return n||(n=t),n[0]=e[0]*t[0],n[1]=e[1]*t[1],n[2]=e[2]*t[2],n[3]=e[3]*t[3],n},b.divide=function(e,t,n){return n||(n=t),n[0]=e[0]/t[0],n[1]=e[1]/t[1],n[2]=e[2]/t[2],n[3]=e[3]/t[3],n},b.scale=function(e,t,n){return n||(n=e),n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t,n[3]=e[3]*t,n},b.set=function(e,t){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t},b.equal=function(e,t){return e===t||i>Math.abs(e[0]-t[0])&&i>Math.abs(e[1]-t[1])&&i>Math.abs(e[2]-t[2])&&i>Math.abs(e[3]-t[3])},b.negate=function(e,t){return t||(t=e),t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t},b.length=function(e){var t=e[0],n=e[1],i=e[2],r=e[3];return Math.sqrt(t*t+n*n+i*i+r*r)},b.squaredLength=function(e){var t=e[0],n=e[1],i=e[2],r=e[3];return t*t+n*n+i*i+r*r},b.lerp=function(e,t,n,i){return i||(i=e),i[0]=e[0]+n*(t[0]-e[0]),i[1]=e[1]+n*(t[1]-e[1]),i[2]=e[2]+n*(t[2]-e[2]),i[3]=e[3]+n*(t[3]-e[3]),i},b.str=function(e){return"["+e[0]+", "+e[1]+", "+e[2]+", "+e[3]+"]"},e&&(e.glMatrixArrayType=a,e.MatrixArray=a,e.setMatrixArrayType=t,e.determineMatrixArrayType=n,e.glMath=r,e.vec2=g,e.vec3=o,e.vec4=b,e.mat2=_,e.mat3=p,e.mat4=m,e.quat4=f),{glMatrixArrayType:a,MatrixArray:a,setMatrixArrayType:t,determineMatrixArrayType:n,glMath:r,vec2:g,vec3:o,vec4:b,mat2:_,mat3:p,mat4:m,quat4:f}});